---
output: github_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Final Project: Video Game Sales

#### Analyn Seeman, Devon Katragadda, Cassidy Berghoff, and Sofi Gutierrez

## Introduction

The video game industry is one of the largest and fastest-growing
entertainment sectors in the world, engaging audiences across the world.
With the rise of digital distribution platforms, online reviews, and
global gaming communities, understanding what contributes to a video
game's commercial and critical success has become more relevant than
ever for developers, publishers, and marketers alike.

This project aims to explore the factors that define a successful video
game by analyzing historical data across multiple categories such as
sales, ratings, platforms, genres, and geographic trends. By examining
these attributes, we hope to identify patterns and correlations that can
offer insights into consumer preferences and industry dynamics.

To guide our analysis, we focus on the following research questions:

1.  Which genre has the best sales?

2.  Is there a relationship between user rating and sales? What about
    critic rating in sales? Which one would be better marker for a
    bestseller?

3.  Which platform had the most successful games?

4.  Which platform's games have the best rating? Does platform affect
    the above questions?

5.  What is the most popular genre per platform?

6.  What years were most successful for video games

7.  During the best years, which genres were most popular?

8.  What is the most popular genre by area?

By answering these questions, we aim to identify key trends that
influence the success of a video game. The insights gained from this
analysis can help video game developers find the best chance of success
in the gaming industry.

## Data

### Uploading Data Set

```{r}

data = read.csv("Video Game Sales 1978 - 2024 export 2025-03-31 22-10-49.csv")

head(data)
# View(data)
```

```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
```

### Description of Data Set

```{r}

str(data)
# View(data)

```

This data set compiles data from video game sales from 1978 to 2024.
There are 16 columns in this data set, representing the 16 variables in
the data set.

### Variables

-   Rank: The index of the data set
-   Name: The name of the game
-   Platform: The platform that the game was released for
-   All_Platforms: A variable that holds a "list" that describes which
    platforms a game is on if it is on multiple
-   All_Games: A list of all of the games in that series
-   Publisher: The publisher of the games
-   Developer: The people that developed the game
-   Critic_Score: What numeric value the critics gave the game (NA,
    0-10)
-   User_Score: What numeric value the users gave the game (NA, 0-10)
-   NA_Sales: Sales in the North American region
-   PAL_Sales: Sales in the European region
-   JP_Sales: Sales in the Eastern Asia region
-   Other_Sales: Sales in all other regions
-   Global_Sales: Year: The year the game was released (if in a series,
    the year the most recent game was released)
-   Genre: The genre of the game

### Cleaning of Data Set

```{r}

q1_data <- data %>%
  drop_na(Global_Sales) #dropping games with no available Sale data

q2_data <- q1_data %>%
  drop_na(Critic_Score) %>%
  drop_na(User_Score)   #dropping games with no available Sale data

```

## Marginal Summaries

```{r}

q1_data %>%
  group_by(Platform) %>%
  summarise(maxSales = max(Global_Sales)) #3

# Anything with critic ratings, user ratings, and sales data 
q2_data %>%
  group_by(Platform) %>%
  summarise(maxUserScore = max(User_Score), maxCriticScore = max(Critic_Score)) #4

```

## Results

### Question 1: Which genre has the best sales?

```{r}
q1_genre <- q1_data %>%
  group_by(Genre) %>%
  summarise(totalSales = sum(Global_Sales)) %>%
  arrange(desc(totalSales))

q1_genre
```

```{r}
ggplot(q1_genre, aes(x = Genre, weight= totalSales)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90)) +
  ylab("Total Sales")
```

The above table shows the total global sales per video game genre. It is
sorted in decreasing order, meaning the most popular genre is located in
the top row. The genre with the highest total sales indicates the most
popular genre globally. Since `Sports` has the highest `totalSale`
value, it is the most popular genre globally.

```{r}
ggplot(data, aes(x = Year, y = log(Global_Sales), color = Critic_Score)) +
  geom_point()
```

### Question 2: Is there a relationship between user rating and sales? What about critic rating?

```{r}

# Scatter plot for user score vs global sales
ggplot(q2_data, aes(x = User_Score, y = Global_Sales)) +
  geom_point() +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "User Score vs Global Sales", x = "User Score", y = "Global Sales")

# Scatter plot for critic score vs global sales
ggplot(q2_data, aes(x = Critic_Score, y = Global_Sales)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Critic Score vs Global Sales", x = "Critic Score", y = "Global Sales")

# These scatter plots will visually explore potential correlations between scores (user and critic) and sales. Regression lines provide insights into the strength and direction of the relationships.
```

### Question 3: Which platform had the most successful games?

```{r}

# Define brand colors
company_colors <- c(
  "Nintendo"  = "#F4A6A6",  # Pastel red
  "Sony"      = "#A6B8E6",  # Pastel blue
  "Microsoft" = "#A9D6A4",  # Pastel green
  "PC"        = "#C0C0C0"   # Light gray
)

# Add Company info to platform summary
q1_platform <- q1_data %>%
  group_by(Platform) %>%
  summarise(totalSales = sum(Global_Sales, na.rm = TRUE)) %>%
  mutate(
    Company = case_when(
      Platform %in% c("N64", "NS", "Wii", "DS", "NES", "GC") ~ "Nintendo",
      Platform %in% c("PS", "PS2", "PS3", "PS4", "PSP", "PSN") ~ "Sony",
      Platform %in% c("XB", "X360", "XOne") ~ "Microsoft",
      Platform == "PC" ~ "PC",
      TRUE ~ "Other"
    )
  ) %>%
  filter(Company != "Other") %>%
  arrange(desc(totalSales))

# Plot with color-coded bars
ggplot(q1_platform, aes(x = reorder(Platform, -totalSales), y = totalSales, fill = Company)) +
  geom_col() +
  scale_fill_manual(values = company_colors) +
  labs(
    title = "Total Global Sales by Platform",
    subtitle = "Color-coded by Platform Brand",
    x = "Platform",
    y = "Total Global Sales (in millions)",
    fill = "Brand"
  ) +
  scale_y_continuous(labels = scales::comma_format()) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 9),
    axis.text.y = element_text(size = 10)
  )


# This will list the platforms ranked by total global sales. The platform with the highest total sales is deemed the most successful.
```

```{r}

# Define company colors
company_colors <- c(
  "Nintendo"  = "#F4A6A6",  # Pastel red
  "Sony"      = "#A6B8E6",  # Pastel blue
  "Microsoft" = "#A9D6A4",  # Pastel green
  "PC"        = "#C0C0C0"   # Light gray
)

# Summarize and reshape data
platform_region_sales <- q1_data %>%
  group_by(Platform) %>%
  summarise(
    NA_Sales = sum(NA_Sales, na.rm = TRUE),
    PAL_Sales = sum(PAL_Sales, na.rm = TRUE),
    JP_Sales = sum(JP_Sales, na.rm = TRUE),
    Other_Sales = sum(Other_Sales, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = c(NA_Sales, PAL_Sales, JP_Sales, Other_Sales),
    names_to = "Region",
    values_to = "Sales"
  ) %>%
  mutate(
    Region = recode(Region,
                    "NA_Sales" = "North America",
                    "PAL_Sales" = "Europe",
                    "JP_Sales" = "Japan",
                    "Other_Sales" = "Other"),
    Company = case_when(
      Platform %in% c("N64", "NS", "Wii", "DS", "NES", "GC") ~ "Nintendo",
      Platform %in% c("PS", "PS2", "PS3", "PS4", "PSP", "PSN") ~ "Sony",
      Platform %in% c("XB", "X360", "XOne") ~ "Microsoft",
      Platform == "PC" ~ "PC",
      TRUE ~ "Other"
    )
  ) %>%
  filter(Company != "Other")  # remove unknown brands

# Plot: Facet by Region, color by Company
ggplot(platform_region_sales, aes(x = reorder(Platform, -Sales), y = Sales, fill = Company)) +
  geom_col(show.legend = TRUE) +
  scale_fill_manual(values = company_colors) +
  facet_wrap(~ Region, scales = "free_y") +
  labs(
    title = "Platform Sales by Region",
    x = "Platform",
    y = "Total Sales (in millions)",
    fill = "Brand"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(size = 10, angle = 60, hjust = 1, vjust = 1),
    strip.placement = "outside",
    strip.background = element_blank(),
    panel.spacing = unit(1.5, "lines"),
    plot.title = element_text(face = "bold", size = 16)
  )


```

### Question 4: Which platform's games have the best rating?

```{r}
q2_platform <- q2_data %>%
  group_by(Platform) %>%
  summarise(
    avgUserScore = mean(User_Score, na.rm = TRUE),
    avgCriticScore = mean(Critic_Score, na.rm = TRUE)
  ) %>%
  arrange(desc(avgUserScore), desc(avgCriticScore))

q2_platform

# Platforms are ranked based on average user and critic scores. A high average score might indicate quality gaming experiences on that platform
```

### Question 5: What does game success (sales) look like for each platform?

```{r}
# data %>% filter(Platform %in% c("N64", "XB","PS4", "PSP", "PS2", "PS3", "PSN", "NS", "PC", "X360", "DS", "Wii", "NES", "GC", "XOne", "PS", ""), Global_Sales > 5) %>% ggplot(aes(x=Platform, y=Global_Sales)) + geom_boxplot()

```

```{r}

# Add Company column to high_sales_platforms
high_sales_platforms <- q1_data %>%
  filter(Global_Sales > 5,
         Platform %in% c("N64", "XB", "PS4", "PSP", "PS2", "PS3", "PSN", 
                         "NS", "PC", "X360", "DS", "Wii", "NES", "GC", 
                         "XOne", "PS")) %>%
  mutate(
    Company = case_when(
      Platform %in% c("N64", "NS", "Wii", "DS", "NES", "GC") ~ "Nintendo",
      Platform %in% c("PS", "PS2", "PS3", "PS4", "PSP", "PSN") ~ "Sony",
      Platform %in% c("XB", "X360", "XOne") ~ "Microsoft",
      Platform == "PC" ~ "PC"
    )
  )

# Define custom color mapping
company_colors <- c(
  "Nintendo"  = "#F4A6A6",  # Pastel red
  "Sony"      = "#A6B8E6",  # Pastel blue
  "Microsoft" = "#A9D6A4",  # Pastel green
  "PC"        = "#C0C0C0"   # Light gray
)


# Plot with custom colors
ggplot(high_sales_platforms, aes(x = Platform, y = Global_Sales, fill = Company)) +
  geom_boxplot(outlier.color = "red") +
  scale_fill_manual(values = company_colors) +
  labs(
    title = "Distribution of Global Sales by Platform",
    x = "Platform",
    y = "Global Sales (in millions)",
    fill = "Platform Brand"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(face = "bold", size = 14)
  )


```

### Question 6: What years were most successful for video games?

```{r}

q1_data %>% ggplot(aes(x = Year, y = Global_Sales)) + geom_col()

```

### Question 7: During the best years, which genres were most popular?

```{r}
q1_data %>% filter(between(Year, 2005, 2015)) %>% ggplot(aes(x = Year, y = Global_Sales)) + geom_col() + facet_wrap(~Genre) + theme(axis.text.x = element_blank(), axis.title.x= element_blank())

```

### Question 8: What is the most popular genre by area?

```{r}
q1_data %>% ggplot(aes(x = Genre, y = NA_Sales)) + geom_col() + theme(axis.text.x = element_text(size = 8, angle = 45, vjust=0.5))
q1_data %>% ggplot(aes(x = Genre, y = PAL_Sales)) + geom_col() + theme(axis.text.x = element_text(size = 8, angle = 45, vjust=0.5))
q1_data %>% ggplot(aes(x = Genre, y = JP_Sales)) + geom_col() + theme(axis.text.x = element_text(size = 8, angle = 45, vjust=0.5))
q1_data %>% ggplot(aes(x = Genre, y = Other_Sales)) + geom_col() + theme(axis.text.x = element_text(size = 8, angle = 45, vjust=0.5))

```

## Conclusion

1.  The genre with the best sales is Sports, highlighting its popularity
    among players worldwide.

2.  There is a positive but not particularly strong relationship between
    both user and critic ratings and global sales. Higher scores
    generally align with better sales, but other variables clearly play
    a role. A moderate/strong relationship exists between critic ratings
    and global sales, suggesting their importance as a marker for
    potential bestsellers. This may indicate that critic ratings carry
    more weight or visibility in influencing purchasing decisions.

3.  The most successful platform in terms of global sales is PS2.

4.  X-Box is home to games with the best average ratings, solidifying
    its reputation for quality.

5.  While X-Box has the best average rating, Nintendo has the best sales
    according to this data. The NES and Wii have the highest Q3 of
    Global Sales, with Wii having the most successful game.

6.  We can see the rise of video games in the 2000's with it peaking
    around 2009. From there it gently declines with a sharp decrease
    in 2020. Was this because of data collection and a bias within the
    data, or for actual reasons? Perhaps the pandemic has caused a
    decline in sales recently.

7.  This further shows the popularity of the sports genre, as it is the
    genre with the highest number of sales in all of the genres. Close
    behind, Shooter and Action are also very popular.

8.  While most areas, such as North America, follow the same pattern
    with Action, Shooter, and Sports being the top 3 games, JP follows a
    different trend. JP stands for Japan. Japan's top performing genres
    are Platform, Role-Playing, and Sports. Role-Playing being the
    significantly most popular game genre. This shows the cultural
    difference between the Americas and Japan.
